<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Expense Tracker</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="budget.css">
    <script src="https://d3js.org/d3.v7.min.js"></script>
</head>

<body>
    <header>
        <div class="top-header">
            <i class="fa fa-bars hamburger" onclick="toggleSidebar()"></i>
            <img src="images/logo.png" alt="Expense Tracker Logo">
            <h1>Expense Tracker - Home page</h1>
        </div>
    </header>
    <div class="mainLayout">
        <div class="sidebar">
            <h2>Dashboard</h2>
            <a href="LoginSite.html" class="btn" target="_blank">Get Started</a>
            <ul>
                <!-- dung font awesome 4. -->
                <li><a href="#"><i class="fa fa-line-chart" aria-hidden="true"></i> Analytics</a></li>
                <li><a href="#"><i class="fa fa-file-text-o" aria-hidden="true"></i></i> Reports</a></li>
                <li><a href="#"><i class="fa fa-cogs" aria-hidden="true"></i></i> Settings</a></li>
                <li><a href="#"><i class="fa fa-eye" aria-hidden="true"></i></i> Overview</a></li>
            </ul>
        </div>

        <!-- Overview -->
        <div class="main-content">
            <div class="stats">
                <div class="stat-card">
                    <i class="fa fa-money" aria-hidden="true" style="color: rgb(76, 175, 80);"></i>
                    <h3>Total Income</h3>
                    <p class="income-text">$13,650.71</p>
                </div>
                <div class="stat-card">
                    <i class="fa fa-shopping-cart" aria-hidden="true" style="color: rgb(244, 67, 54);"></i>
                    <h3>Total Expenses</h3>
                    <p class="expense-text">-$250.00</p>
                </div>
                <div class="stat-card">
                    <i class="fa fa-cc-mastercard" aria-hidden="true" style="color: rgb(33, 150, 243);"></i>
                    <h3>Savings</h3>
                    <p class="balance-text">$13,400.71</p>
                </div>
            </div>

            <div class="chart-placeholder">
                <img src="images/expenseTable.png">
                <div class="container">
                    <div class="chart" id="chart">
                        <div class="total" id="total-expense">-3,017.76</div>
                    </div>
                    <div class="stat-card">
                        <table id="expense-table-title">
                            <tr>
                                <td>
                                    <h2>CHI TIÊU</h2>
                                </td>
                                <td>
                                    <select class="month-selector" onchange="updateChart(this.value)">
                                        <option value="thang-nay">Tháng Này</option>
                                        <option value="thang-truoc">Tháng Trước</option>
                                    </select>
                                </td>
                            </tr>
                        </table>


                        <table id="expense-table">
                            <tr>
                                <th>DANH MỤC</th>
                                <th>CHI TIÊU</th>
                            </tr>
                        </table>
                    </div>
                </div>

                <script>
                    // Dữ liệu chi tiêu cho các tháng
                    const expenseData = {
                        "thang-nay": {
                            total: "-3,017.76",
                            categories: [
                                { name: "Tiền thuê", amount: "-1,479.75", percentage: "49.03%", color: "#ff7f50" },
                                { name: "Nhà cửa", amount: "-616.13", percentage: "20.42%", color: "#f4a460" },
                                { name: "Ăn uống", amount: "-504.62", percentage: "16.72%", color: "#ff4040" },
                                { name: "Mua sắm", amount: "-417.26", percentage: "13.83%", color: "#ffd700" }
                            ]
                        },
                        "thang-truoc": {
                            total: "-2,500.00",
                            categories: [
                                { name: "Tiền thuê", amount: "-1,200.00", percentage: "48.00%", color: "#ff7f50" },
                                { name: "Nhà cửa", amount: "-500.00", percentage: "20.00%", color: "#f4a460" },
                                { name: "Ăn uống", amount: "-400.00", percentage: "16.00%", color: "#ff4040" },
                                { name: "Mua sắm", amount: "-400.00", percentage: "16.00%", color: "#ffd700" }
                            ]
                        }
                    };

                    // Hàm cập nhật biểu đồ và bảng
                    function updateChart(month) {
                        const data = expenseData[month];
                        const chart = document.getElementById('chart');
                        const totalExpense = document.getElementById('total-expense');
                        const table = document.getElementById('expense-table');

                        // Cập nhật tổng chi tiêu
                        totalExpense.textContent = data.total;

                        // Tạo gradient cho biểu đồ tròn
                        let gradient = '';
                        let accumulatedPercentage = 0;
                        data.categories.forEach(category => {
                            const percentage = parseFloat(category.percentage);
                            gradient += `${category.color} ${accumulatedPercentage}% ${accumulatedPercentage + percentage}%`;
                            accumulatedPercentage += percentage;
                            if (category !== data.categories[data.categories.length - 1]) {
                                gradient += ', ';
                            }
                        });
                        chart.style.background = `conic-gradient(${gradient})`;

                        // Cập nhật bảng
                        table.innerHTML = `
                            <tr>
                                <th>DANH MỤC</th>
                                <th>CHI TIÊU</th>
                            </tr>
                            ${data.categories.map(category => `
                                <tr>
                                    <td><span class="tag-color" style="background-color: ${category.color};"></span>${category.name}</td>
                                    <td>${category.amount} (${category.percentage})</td>
                                </tr>
                            `).join('')}
                            <tr>
                                <td><strong>TỔNG</strong></td>
                                <td><strong>${data.total} (100.00%)</strong></td>
                            </tr>
                        `;
                    }

                    // Khởi tạo với dữ liệu tháng này
                    updateChart('thang-nay');
                </script>
            </div>

            <!-- </div> -->
            <div class="lineChart">
                <div class="chart-placeholder">
                    <!-- <div class="stat-card"> -->
                    <div class="chart-container">

                        <svg width="600" height="300"></svg>
                    </div>

                    <script>
                        // Dữ liệu
                        const data = [
                            { date: 'Feb 24', balance: 11500 },
                            { date: 'Mar 3', balance: 11500 },
                            { date: 'Mar 10', balance: 11500 },
                            { date: 'Mar 17', balance: 11500 },
                            { date: 'Mar 24', balance: 11400 },
                            { date: 'Mar 31', balance: 12500 },
                            { date: 'Apr 7', balance: 12500 },
                            { date: 'Apr 14', balance: 12400 },
                            { date: 'Apr 21', balance: 12500 },
                            { date: 'Apr 28', balance: 13500 }
                        ];

                        // Kích thước biểu đồ
                        const width = 700;
                        const height = 300;
                        const margin = { top: 20, right: 25, bottom: 30, left: 60 };
                        const chartWidth = width - margin.left - margin.right;
                        const chartHeight = height - margin.top - margin.bottom;

                        // Tạo SVG
                        const svg = document.querySelector('svg');
                        svg.setAttribute('width', width);
                        svg.setAttribute('height', height);

                        const g = document.createElementNS('http://www.w3.org/2000/svg', 'g');
                        g.setAttribute('transform', `translate(${margin.left},${margin.top})`);
                        svg.appendChild(g);

                        // Tỷ lệ
                        const xScale = (index) => (index * chartWidth) / (data.length - 1);
                        const yScale = (value) => {
                            const min = 11000;
                            const max = 14000;
                            return chartHeight - ((value - min) * chartHeight) / (max - min);
                        };

                        // Tạo tooltip
                        const tooltip = document.createElement('div');
                        tooltip.style.position = 'absolute';
                        tooltip.style.backgroundColor = 'white';
                        tooltip.style.border = '1px solid #ccc';
                        tooltip.style.borderRadius = '5px';
                        tooltip.style.padding = '5px';
                        tooltip.style.boxShadow = '0 0 5px rgba(0,0,0,0.2)';
                        tooltip.style.pointerEvents = 'none';
                        tooltip.style.display = 'none';
                        document.body.appendChild(tooltip);



                        // Vẽ đường
                        let linePath = `M0,${yScale(data[0].balance)}`;
                        for (let i = 1; i < data.length; i++) {
                            linePath += ` L${xScale(i)},${yScale(data[i].balance)}`;
                        }

                        const line = document.createElementNS('http://www.w3.org/2000/svg', 'path');
                        line.setAttribute('d', linePath);
                        line.setAttribute('class', 'line');
                        g.appendChild(line);

                        // Vẽ vùng dưới đường
                        let areaPath = `M0,${yScale(data[0].balance)}`;
                        for (let i = 1; i < data.length; i++) {
                            areaPath += ` L${xScale(i)},${yScale(data[i].balance)}`;
                        }
                        areaPath += ` L${xScale(data.length - 1)},${chartHeight} L0,${chartHeight} Z`;

                        const area = document.createElementNS('http://www.w3.org/2000/svg', 'path');
                        area.setAttribute('d', areaPath);
                        area.setAttribute('class', 'area');
                        g.appendChild(area);

                        // Vẽ trục x
                        data.forEach((d, i) => {
                            const text = document.createElementNS('http://www.w3.org/2000/svg', 'text');
                            text.setAttribute('x', xScale(i));
                            text.setAttribute('y', chartHeight + 20);
                            text.setAttribute('text-anchor', 'middle');
                            text.textContent = d.date;
                            g.appendChild(text);
                        });

                        // Vẽ trục y
                        const yTicks = [11000, 11500, 12000, 12500, 13000, 13500, 14000];
                        yTicks.forEach(value => {
                            const text = document.createElementNS('http://www.w3.org/2000/svg', 'text');
                            text.setAttribute('x', -10);
                            text.setAttribute('y', yScale(value));
                            text.setAttribute('text-anchor', 'end');
                            text.setAttribute('dy', '0.32em');
                            text.textContent = `$${value / 1000}k`;
                            g.appendChild(text);

                            const line = document.createElementNS('http://www.w3.org/2000/svg', 'line');
                            line.setAttribute('x1', 0);
                            line.setAttribute('y1', yScale(value));
                            line.setAttribute('x2', chartWidth);
                            line.setAttribute('y2', yScale(value));
                            line.setAttribute('stroke', '#ccc');
                            g.appendChild(line);
                        });
                        // chấm tròn và sự kiện
                        data.forEach((d, i) => {
                            const circle = document.createElementNS('http://www.w3.org/2000/svg', 'circle');
                            circle.setAttribute('cx', xScale(i)); // Tọa độ x
                            circle.setAttribute('cy', yScale(d.balance)); // Tọa độ y
                            circle.setAttribute('r', 4); // Bán kính chấm tròn
                            circle.setAttribute('fill', 'steelblue'); // Màu chấm tròn

                            // Thêm sự kiện chuột
                            circle.addEventListener('mouseover', (event) => {
                                tooltip.style.display = 'block';
                                tooltip.innerHTML = `<div>${d.date}</div><div>$${d.balance.toLocaleString()}</div>`;
                            });
                            circle.addEventListener('mousemove', (event) => {
                                tooltip.style.left = `${event.pageX + 10}px`;
                                tooltip.style.top = `${event.pageY + 10}px`;
                            });
                            circle.addEventListener('mouseout', () => {
                                tooltip.style.display = 'none';
                            });

                            g.appendChild(circle);
                        });
                    </script>

                    <img src="images/balance.png">
                </div>
            </div>

            <!-- Bar Chart -->
            <div class="barChart">
                <div class="chart-placeholder">
                    <div class="chart-container">
                        <h2>Daily Expenses for the Last 7 Days</h2>
                        <svg width="800" height="400"></svg>
                    </div>
                    <script>
                        // Data for the bar chart (last 7 days expenses)
                        const barData = [
                            { date: "22 Tue", expense: 120, color: "#ff4040" },
                            { date: "23 Wed", expense: 40, color: "#4caf50" },
                            { date: "24 Thu", expense: 20, color: "#ff4040" },
                            { date: "25 Fri", expense: 80, color: "#ff4040" },
                            { date: "26 Sat", expense: 50, color: "#ff4040" },
                            { date: "27 Sun", expense: 30, color: "#ff4040" },
                            { date: "28 Mon", expense: 70, color: "#4caf50" }
                        ];


                        const barWidth = 800;
                        const barHeight = 400;
                        const barMargin = { top: 40, right: 25, bottom: 70, left: 60 };
                        const barChartWidth = barWidth - barMargin.left - barMargin.right;
                        const barChartHeight = barHeight - barMargin.top - barMargin.bottom;

                        // Select the SVG for the bar chart
                        const barSvg = d3.select(".barChart .chart-container svg")
                            .attr("width", barWidth)
                            .attr("height", barHeight);

                        const barG = barSvg.append("g")
                            .attr("transform", `translate(${barMargin.left},${barMargin.top})`);

                        // Scales
                        const xScaleBar = d3.scaleBand()
                            .domain(barData.map(d => d.date))
                            .range([0, barChartWidth])
                            .padding(0.2);

                        const yScaleBar = d3.scaleLinear()
                            .domain([0, 120])
                            .range([barChartHeight, 0]);

                        // Draw bars
                        barG.selectAll("rect")
                            .data(barData)
                            .enter()
                            .append("rect")
                            .attr("x", d => xScaleBar(d.date))
                            .attr("y", d => yScaleBar(d.expense))
                            .attr("width", xScaleBar.bandwidth())
                            .attr("height", d => barChartHeight - yScaleBar(d.expense))
                            .attr("fill", d => d.color);

                        // X-axis
                        barG.append("g")
                            .attr("transform", `translate(0,${barChartHeight})`)
                            .call(d3.axisBottom(xScaleBar))
                            .selectAll("text")
                            .style("font-size", "14px") 
                            .attr("transform", "rotate(-45)") 
                            .attr("text-anchor", "end")
                            .attr("x", -10)
                            .attr("y", 10);

                        // Y-axis
                        barG.append("g")
                            .call(d3.axisLeft(yScaleBar)
                                .tickFormat(d => `$${d}`))
                            .selectAll("text")
                            .style("font-size", "14px"); 

                        // Add Y-axis label
                        barSvg.append("text")
                            .attr("transform", "rotate(-90)")
                            .attr("x", -barHeight / 2)
                            .attr("y", 20)
                            .style("text-anchor", "middle")
                            .text("Expenses")
                            .style("font-size", "16px"); 
                    </script>
                </div>
            </div>
        </div>
    </div>
    </div>
    </div>
</body>
<footer>
    <div class="footer-container">
        <div class="first-ele">
            <img src="Design/logopng.png" alt="" style="width: 80px;">
            <p>Easily track your expenses, manage your budget effectively, and make smarter financial decisions. Our
                expense tracker empowers you to take control of your personal finances, leading to greater peace of mind
                and financial freedom in the future.</p>
            <i class="fa fa-facebook-official" aria-hidden="true"></i>
            <i class="fa fa-instagram" aria-hidden="true"></i>
        </div>

        <div class="second-ele">
            <h4>Usefull Links</h4>
            <ul type="none">
                <li>About us</li>
                <li>Contact us</li>
                <li>Terms of Services</li>
                <li>Plan & Precing</li>
                <li>Site Map</li>
            </ul>
        </div>

        <div class="third-ele">
            <h4>Contact Us</h4>
            <ul class="phone-num" type="none">
                <li><i class="fa fa-phone" aria-hidden="true"></i> Phone Number: +84..(The Liems)</li>
            </ul>
            <ul class="mail-address" type="none">
                <li><i class="fa fa-envelope-o" aria-hidden="true"></i> Email: theliems.support@eiu.edu.vn
                </li>
            </ul>
            <ul class="address" type="none">
                <li>
                    <i class="fa fa-map" aria-hidden="true"></i><a href="https://maps.app.goo.gl/5MSLK73v9266wtg96"
                        target="_blank"> Address: Thu Dau Mot - Binh
                        Duong</a>
                </li>
                <li><i class="fa fa-university" aria-hidden="true"></i><a
                        href="https://maps.app.goo.gl/usEamfmgeRZYH9u59" target="_blank"> Eastern International
                        University</a>
                </li>
            </ul>
        </div>
    </div>
</footer>

<script src="https://unpkg.com/boxicons@2.1.4/dist/boxicons.js"></script>

</html>